InternalClassType: Comment
Cont: |+1
 
 
 param current_table_ORG : any
 
 var pointY, start_seq_no, dest_seq_no, i_position, counter, one_pos , level: integer
 var dest, start, objs_returned : object[]
 
 
 counter := 0
 for var a := 1 to current_table_ORG.ydim loop
 	if current_table_ORG["Sequence_Number", a] /= 0 then
 		one_pos := a
 		counter += 1
 	end
 next
 
 for var j := 1 to current_table_ORG.ydim loop
 	
 	if counter > 1 then
 		current_table_ORG.sort("Sequence_Number", "up")
 		i_position := current_table_ORG["Sequence_Number", j]
 		level := current_table_ORG["Level", j]
 		
 	
 		Created_Objects.CursorY := 1
 		var bfound : boolean := Created_Objects.find({"Occ_ID", *}, current_table_ORG["Occ_ID", j].Name)
 		pointY := Created_Objects.CursorY
 		
 		if i_position /= 0 then
 			
 			if current_table_ORG["Type", j] = "Resource" and bfound = true
 				if start.dim = 0 then
 					start.append(Created_Objects["Link", pointY])
 					start_seq_no := i_position
 					
 				elseif start_seq_no = i_position and start.dim /= 0 then
 					start.append(Created_Objects["Link", pointY])
 					
 				elseif dest_seq_no = i_position or dest.dim = 0 then
 					dest.append(Created_Objects["Link", pointY])
 					dest_seq_no := i_position
 					
 				elseif start.dim /= 0 and i_position /= dest_seq_no and i_position /= start_seq_no then
 					connectObjects(start, dest)
 			
 				
 					start.delete
 					for var y := 1 to current_table_ORG.ydim loop
 						if current_table_ORG["Sequence_Number", y] = dest_seq_no then
 							
 							if current_table_ORG["Type", y] = "Resource" then
 								start := dest
 							end
 						end
 					next
 					
 				
 					dest.delete
 					for var z := 1 to current_table_ORG.ydim loop
 						if current_table_ORG["Sequence_Number", z] = i_position then
 							
 							if current_table_ORG["Type", z] = "Resource" then
 								dest.append(Created_Objects["Link", pointY])
 							end
 						end
 					next
 					
 					start_seq_no := dest_seq_no
 					dest_seq_no := i_position
 				end
 				
 				if j = current_table_ORG.ydim then
 					connectObjects(start, dest)
 				end
 			
 			
 				
 				if j = current_table_ORG.ydim then
 					connectObjects(start, dest)
 				end
 			end
 			
 		end
 		
 	elseif 	counter = 1 then
 	
 		var next_table : table := current_table_ORG["Occ_ID", one_pos]
 		self.execute(next_table)
 	end
 	
 next
 	
 	
 for var b := 1 to current_table_ORG.ydim loop
 
 	var sub_table : table := current_table_ORG["Occ_ID", b]
 	self.execute(sub_table)
 next
Origin: c5ce3683-2ad7-434d-a125-e9ab898a8a5e
SaveAsRichedit: false
UUID: 1f268075-eb1f-4137-857c-a9ec529aae6a
