InternalClassType: Comment
Cont: |+1
 
 
 param source : string, pRow : integer, byref VariantsTab : table, homeframe : object
 
 
 var Product_Data : object := homeframe.Product_Data
 var Process_Data : object := homeframe.Process_Data
 
 
 
 switch source
 case "product"
 	var vStr : string := Product_Data["Variants", pRow]
 case "process"
 	vStr := Process_Data["Variants", pRow]
 end
 
 repeat
 
 	var p1 := pos("[Teamcenter]", vStr )        
 	if p1 > 0
 		p1 += 12 								
 		vStr := omit(vStr, 0, p1)				
 		var p2 : integer := pos("=", vStr ) - 1	
 		var variantsname := copy( vStr, 0, p2 )
 		var VarCol : integer := VariantsTab.getColumnNo(variantsname)
 		if VarCol = -1
 			VarCol := VariantsTab.XDimIndex + 1                      
 			VariantsTab[VarCol, 0] := variantsname
 		end
 		
 		vStr := omit(vStr, 0, p2 + 3)			
 
 		if copy( vStr, 1, 1 ) = "'"				
 			vStr := omit(vStr, 1, 1)
 			p2 := pos("'", vStr ) 				
 		else
 			var p2a : integer[]					
 			if pos("|", vStr ) > 0
 				p2a.append(pos("|", vStr ) -1)
 			else
 				p2a.append(strlen(vStr) + 1)	
 			end
 			if pos("&", vStr ) > 0
 				p2a.append(pos("&", vStr ) -1)
 			else
 				p2a.append(strlen(vStr) + 1)
 			end
 			if pos(")", vStr ) > 0
 				p2a.append(pos(")", vStr ))
 			else
 				p2a.append(strlen(vStr) + 1)
 			end
 			p2 := p2a.min 						
 		end
 		VariantsTab[1, VarCol] := incl(copy( vStr, 0, p2 ) + ",", VariantsTab[1, VarCol], 1) 
 
 
 		vStr := omit(vStr, 0, p2) 				
 	end;
 
 until pos("[Teamcenter]", vStr ) = 0
 
 
 if source = "product" AND Product_Data["ParentID", pRow] /= ""
 	Product_Data.setCursor(1,1)
 	if Product_Data.find({"ID",1}..{"ID",*}, Product_Data["ParentID", pRow])
 		var pRow2 := Product_Data.CursorY
 		self.execute(source, pRow2, VariantsTab, homeframe)
 	end
 end
Origin: c5ce3683-2ad7-434d-a125-e9ab898a8a5e
SaveAsRichedit: false
UUID: f15b6e5e-a49b-4e4e-9067-56f1360ebd32
